(function(){var a=document.getElementsByTagName("script");var c=a[a.length-1].src;if(c.length==0){c=window.installPath+"/ac-angular-reportes/includes/mv-reportes.php"}angular.module("acReportes",[]).component("acReportes",e()).factory("ReportesService",d);function e(){return{bindings:{},templateUrl:window.installPath+"/ac-angular-reportes/mv-reportes.html",controller:b}}b.$inject=["$rootScope"];function b(f){var g=this;g.reporte="stock";f.$on("$routeChangeStart",function(j,i,k){var h=i.$$route.originalPath.split("/");g.reporte=(h[1]=="reportes")?h[2]:"";console.log(g.reporte)})}d.$inject=["$http","$window"];function d(o,h){var m={};var g=c.replace("mv-reportes.js","/includes/mv-reportes.php");var i="data:application/vnd.ms-excel;base64,",q='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',l=function(t){return h.btoa(unescape(encodeURIComponent(t)))},p=function(t,u){return t.replace(/{(\w+)}/g,function(s,v){return u[v]})};m.getMargenes=f;m.getTotalesPorCuenta=n;m.cierreDeCaja=r;m.tableToExcel=j;m.getResumenStock=k;return m;function k(){}function r(s,t,u){o.get(g+"?function=cierreDeCaja&sucursal_id="+s+"&pos_id="+t).success(function(v){u(v)}).error(function(v){u(v)})}function f(s,v,w){var u=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate();var t=v.getFullYear()+"-"+(v.getMonth()+1)+"-"+v.getDate();o.get(g+"?function=getMargenes&desde="+u+"&hasta="+t).success(function(x){w(x)}).error(function(x){w(x)})}function n(s,v,w){var u=s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate();var t=v.getFullYear()+"-"+(v.getMonth()+1)+"-"+v.getDate();o.get(g+"?function=getTotalesPorCuenta&desde="+u+"&hasta="+t).success(function(x){w(x)}).error(function(x){w(x)})}function j(w,u){var v=document.getElementById(w),s={worksheet:u,table:v.innerHTML},t=i+l(p(q,s));return t}}})();